Type.registerNamespace("Mscrm");function loadArea(selectedNavLink,area,parameters,url,isvMode,passParams){return Mscrm.Details.loadArea(selectedNavLink,area,parameters,url,isvMode,passParams)}function loadIsvArea(selectedNavLink,url,passParams,domEvent){return Mscrm.Details.loadIsvArea(selectedNavLink,url,passParams,domEvent)}function addActivityTo(typeCode,id,type,name,partyId,partyType,partyName,location,contentId){Mscrm.AddActivity.addActivityTo(typeCode,id,type,name,partyId,partyType,partyName,location,contentId)}Mscrm.Details=function(){};Mscrm.Details.$$cctor=function(){$addHandler(window,"unload",Mscrm.Details.handleUnloadEvent)};Mscrm.Details.handleUnloadEvent=function(domEvent){Mscrm.Details.currentArea=null;$removeHandler(window,"unload",Mscrm.Details.handleUnloadEvent)};Mscrm.Details.get_usingMainFormRibbonData=function(){return !IsNull($get("areaForm"))};Mscrm.Details.loadArea=function(selectedNavLink,area,parameters,url,isvMode,passParams){if(!Mscrm.FormNavControl.isNavLinkEnabled(selectedNavLink))return false;var $v_0=$get("tdAreas"),$v_1=XUI.Html.DomUtils.GetFirstChild($v_0);if($v_1.className==="ms-crm-IE7-Height-Fix-Dummy-Container"||$v_1.className==="ms-crm-IE7-Height-Fix-Dummy-Container-ReadForm")$v_0=$v_1;var $v_2=false;if(IsNull(parameters))parameters="";else if(parameters.length>0&&(parameters.charAt(0)==="&"||parameters.charAt(0)==="?"))parameters=parameters.substr(1);if(parameters.length>11){var $v_7=Mscrm.CrmUri.create("areas.aspx?"+parameters);if($v_7.get_query()["refreshmode"]==="1")$v_2=true;delete $v_7.get_query().refreshmode;var $v_8=$v_7.get_queryString();if(!isNullOrEmptyString($v_8))if($v_8.charAt(0)==="&"||$v_8.charAt(0)==="?")$v_8=$v_8.substr(1);parameters=$v_8}if(!Mscrm.Details.currentArea)Mscrm.Details.currentArea=XUI.Html.DomUtils.GetFirstChild($v_0);var $v_3=null,$v_4=function($p1_0){var $v_O=$p1_0;if($v_O.id===area){var $v_P=IsNull($v_O.params)?"":$v_O.params;if($v_P===parameters){$v_3=$v_O;return true}}return false};XUI.Html.DomUtils.ForEachChild($v_0,$v_4);setSelectedControl(null);if(!IsNull($v_3)){if($v_3===Mscrm.Details.currentArea&&!$v_2)return false;Mscrm.Details.$1();Mscrm.Details.currentArea.style.display="none";$v_3.style.display="";if($v_2){var $v_C=XUI.Html.DomUtils.GetFirstChild($v_3);$v_C.contentWindow.location.reload()}var $v_9=Mscrm.Details.$0(Mscrm.Details.currentArea);unloadRibbonData($v_9);var $v_A=Mscrm.Details.$0($v_3),$v_B=window._initialTabId;window._initialTabId=null;if(isNullOrEmptyString($v_B))$v_B=null;loadRibbonData($v_A,$v_B);Mscrm.Details.$6($v_3)}else{var $v_D=Mscrm.Details.$4(parameters),$v_E=true;if(url){url.checkParamsNoEqual=true;if(!url.isEmpty()){var $v_L=url.toString();$v_D=Mscrm.CrmUri.create($v_L+($v_L.indexOf("?")===-1?"?":"&")+parameters);if(!$v_D.get_path().toLowerCase().endsWith("areas.aspx"))$v_E=false}}var $v_F=$get("crmFormSubmit"),$v_G=null;$v_G=isNullOrEmptyString($v_F.crmFormSubmitId.value)?Xrm.Page.data.entity.getId():$v_F.crmFormSubmitId.value;if(IsNull(passParams)||true===passParams){if(!IsNull(isvMode)&&isvMode){$v_D.get_query()["id"]=$v_G;$v_D.get_query()["type"]=$v_F.crmFormSubmitObjectType.value;$v_D.get_query()["typename"]=$v_F.crmFormSubmitObjectTypeName.value}else{$v_D.get_query()["oId"]=$v_G;$v_D.get_query()["oType"]=$v_F.crmFormSubmitObjectType.value;$v_D.get_query()["rof"]=Mscrm.Details.$2().toString()}if(window._IsRefreshForm==="1")$v_D.get_query()["theme"]=window.RefreshFormTheme;var $v_M=XUI.Html.GetText(selectedNavLink);if($v_E&&!isNullOrEmptyString($v_M))$v_D.get_query()["navItemName"]=$v_M.trim();$v_D.get_query()["security"]=$v_F.crmFormSubmitSecurity.value;$v_D.get_query()["tabSet"]=area;$v_D.get_query()["pagemode"]="iframe";var $v_N=$find("crmFormSelector");if($v_N)$v_D.get_query()["formid"]=$v_N.get_currentFormId()}$v_3=document.createElement("DIV");$v_3.id=area;$v_3.className="ms-crm-Form-Area";if(!IsNull(parameters))$v_3.params=parameters;$v_D.checkParamsNoEqual=true;var $v_H=$v_D.toString();Mscrm.PerformanceTracing.write("Navigate",$v_H);var $v_I=CrmEncodeDecode.CrmHtmlAttributeEncode(area),$v_J="100%";$v_3.innerHTML=String.format("<iframe allowTransparency='-1' src='"+CrmEncodeDecode.CrmHtmlAttributeEncode($v_H)+"' id='"+$v_I+"Frame' name='"+$v_I+"Frame' scrolling='auto' isArea='1' frameborder='0' style=\"width: 100%; height: {0}\"></iframe>",$v_J);Mscrm.Details.$1();Mscrm.Details.currentArea.style.display="none";Mscrm.Details.$7($v_0);$v_0.appendChild($v_3);var $v_K=Mscrm.Details.$0(Mscrm.Details.currentArea);unloadRibbonData($v_K)}Mscrm.Details.currentArea=$v_3;Mscrm.Details.resetBreadcrumb(selectedNavLink);var $v_5=$get("_MBdocumentallRelatedInformationPaneExpanddocumentallRelatedInformationPaneLoadContextDatafollowup");if($v_5)$v_5.disabled=area!=="areaForm";var $v_6=XUI.Html.DomUtils.GetFirstChild($v_3);$addHandler($v_6,"load",Mscrm.Details.$5);return true};Mscrm.Details.$1=function(){if(!IsNull(Mscrm.Details.currentArea)){var $v_0=XUI.Html.DomUtils.GetFirstChild(Mscrm.Details.currentArea);if(!IsNull($v_0)&&!IsNull($v_0.contentWindow))try{$v_0.contentWindow.Mscrm.Menu.hideOpenedMenu()}catch($$e_1){}}};Mscrm.Details.$4=function($p0){var $v_0=Mscrm.Utilities.getContentUrl(null);if(Mscrm.Details.$2())return Mscrm.CrmUri.create("/userdefined/areas.aspx?"+$p0);return Mscrm.CrmUri.create("areas.aspx?"+$p0,$v_0.toString())};Mscrm.Details.$2=function(){var $v_0=$get("rofContainer");return !IsNull($v_0)};Mscrm.Details.$6=function($p0){for(var $v_0=$p0.getElementsByTagName("select"),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1],$v_3=$v_2.size;$v_2.size=$v_3+2;$v_2.size=$v_3}};Mscrm.Details.$7=function($p0){var $v_0=$get("progress");if(!$v_0){$v_0=document.createElement("DIV");$p0.appendChild($v_0);$v_0.id="progress";var $v_1=window.LOCID_PAGELOADING_MSG;$v_0.innerHTML="<div class='ms-crm-IE7-Height-Fix-Dummy-Container'><TABLE class='ms-crm-Loading-Message' morerecords='0'><TR><TD ID='GridLoadingMessage'><IMG alt='' src='/_imgs/AdvFind/progress.gif'><br>"+CrmEncodeDecode.CrmHtmlEncode($v_1)+"</TD></TR></TABLE></div>";$v_0.className="ms-crm-absolutePosition"}$v_0.style.display="block"};Mscrm.Details.$5=function($p0){var $v_0=$get("progress");if($v_0)$v_0.style.display="none";Mscrm.Details.currentArea.style.display=""};Mscrm.Details.$0=function($p0){if(!Mscrm.Details.$8($p0)){var $v_0=XUI.Html.DomUtils.GetFirstChild($p0);if(!IsNull($v_0)&&$v_0.tagName.toUpperCase()==="IFRAME")try{return $v_0.contentWindow.$find("crmRibbonData")}catch($$e_2){}}return $find("crmRibbonData")};Mscrm.Details.$8=function($p0){return $p0.id==="areaForm"};Mscrm.Details.loadIsvArea=function(selectedNavLink,url,passParams,domEvent){if(passParams)url=addIsvParameters(url);var $v_0=domEvent.target;while(!IsNull($v_0)&&$v_0.tagName!=="A")$v_0=$v_0.parentNode;return Mscrm.Details.loadArea(selectedNavLink,$v_0.id+"Area","",url,true,passParams)};Mscrm.Details.resetBreadcrumb=function(selectedNav){var $v_0=Mscrm.Details.findNavigationComponent(selectedNav,"IMG"),$v_1=Mscrm.Details.findNavigationComponent(selectedNav,"NOBR"),$v_2=$get("leftNavBreadcrumbImg"),$v_3=$get("leftNavBreadcrumbText");if($v_2&&$v_0){$v_2.src=$v_0.src;var $v_4=Mscrm.ImageStrip.getImageStripClassName($v_2);$v_4&&$v_4.length>0&&Sys.UI.DomElement.removeCssClass($v_2,$v_4);var $v_5=Mscrm.ImageStrip.getImageStripClassName($v_0);$v_5&&$v_5.length>0&&Sys.UI.DomElement.addCssClass($v_2,$v_5)}$v_3&&$v_1&&XUI.Html.SetText($v_3,XUI.Html.GetText($v_1))};Mscrm.Details.findNavigationComponent=function(eventSourceElement,elementTagName){var $v_0="A"===eventSourceElement.tagName?eventSourceElement:eventSourceElement.parentNode,$v_1=$v_0.getElementsByTagName(elementTagName)[0];if($v_1)return $v_1;else if(Sys.UI.DomElement.containsCssClass($v_0,"ms-crm-Nav-Subitem-Link")){var $v_2=$v_0.parentNode.parentNode.parentNode.getElementsByTagName("A")[0];if($v_2)return Mscrm.Details.findNavigationComponent($v_2,elementTagName)}return null};Mscrm.Details.registerClass("Mscrm.Details");Mscrm.Details.currentArea=null;Mscrm.Details.$$cctor()